# 数据分析综合实践

数据来源：[Netflix 电影与电视节目数据](https://www.kaggle.com/datasets/shivamb/netflix-shows/data)

任务目标：利用Python对Netflix平台的内容库进行深度清洗、统计与可视化，分析其全球化策略、内容偏好及时间演变趋势。

## 数据概览

1. 数据导入与概览：读取CSV文件，输出数据的维度（行数、列数）、列名、各列的数据类型，并显示前 5 行数据以了解数据结构。
2. 缺失值统计与可视化：计算每一列的缺失值数量及缺失比例。使用 seaborn 绘制热力图（Heatmap）可视化缺失值的分布情况。
3. 缺失值处理策略：
   1. 对于country（国家）、cast（演员）、director（导演）列的缺失值，填充为"Unknown"。
   2. 对于 rating（分级）、duration（时长）列的缺失值，如果数量极少（<1%），则直接删除对应的行。

4. 时间类型转换：将date_added（上架日期）列转换为标准的datetime格式。如果是无法解析的格式，需进行清洗或处理异常值。
5. 时间特征提取：从date_added中提取年份和月份，分别创建两个新列year_added（上架年份）和month_added（上架月份）。

## 数据清洗

1. 时长单位清洗与标准化：duration列包含"90 min"和"1 Season"两种格式。请拆分该列，创建两个新列：

   * duration_num：提取数值部分（整数）。

   - duration_unit：提取单位部分（清洗为 'min' 或 'season'）。

2. 内容分类二值化：针对type列（Movie/TV Show），将其转换为数值编码`Movie=0, TV Show=1`。

3. 多值列处理（国家）：country列中很多内容涉及多个国家（如 "United States, India"）。请编写函数，仅提取第一个国家作为主制作国家，存入新列primary_country。

4. 多值列展开（类型标签）：listed_in 列包含多个题材标签。请统计包含标签数量最多的前 5 部影片，并计算整个数据集中所有影片平均拥有的标签数量。

5. 上架滞后性分析：创建一个新列lag_years，计算公式为year_added减去release_year（上映年份）。若结果为负数，将其修正为0（视为同年上架）

## 统计分析

1. 统计Movie和TV Show的数量，并计算各自的百分比，使用matplotlib绘制饼图（Pie Chart）展示两者比例，需标注百分比数值。
1. 国家产出排行：基于清洗后的 primary_country 列，统计内容数量最多的前10个国家。
1. 年份趋势分析：统计每一年（year_added）上架的内容总数。
1. 热门分级统计：统计不同分级（rating，如TV-MA, PG-13 等）的内容数量，并按数量降序排列。
1. 最勤劳的导演：统计 director 列（需排除 "Unknown"），找出执导作品数量最多的前 10 位导演。

## 业务分析

1. 内容上架的热力图：构建一个透视表（Pivot Table），行索引为 month_added，列索引为year_added（取最近10年），值为内容的数量。使用seaborn绘制热力图，分析Netflix偏好在每年的几月份集中上架新内容。
1. 电影时长分布：仅筛选 type 为 "Movie" 的数据，使用 seaborn 的 histplot 或 kdeplot 绘制电影时长（duration_num）的分布曲线，并标出平均时长。
1. 不同国家的题材偏好：选取内容最多的前 3 个国家（如 USA, India, UK），分别分析这三个国家排名前 5 的题材（listed_in），并尝试用子图（Subplots）展示对比。
1. 电视剧季度数分析：仅筛选 type 为 "TV Show" 的数据，统计拥有 "1 Season", "2 Seasons" ... 等不同季度数的剧集数量，绘制条形图。分析 Netflix 上的剧集是否大多是短命的（只有 1-2 季）。
1. 演员与内容的关联：从cast 列中提取所有演员名字（需解决逗号分隔和列表展开的问题），统计出出现频率最高的10位演员。并用 seaborn绘制条形图，用颜色区分他们主要出演的是Movie还是TV Show（如果在两种类型都出现，归类为占比高的一方）。



