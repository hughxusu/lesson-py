# é¢å‘å¯¹è±¡çš„ç‰¹æ€§

> [!Note]
>
> ä½ æœ‰ä¸€ä¸‡å…ƒçš„å‹å²é’±è¦è¿›è¡ŒæŠ•èµ„ï¼Œå¯ä»¥å­˜å®šæœŸï¼Œä¹Ÿå¯ä»¥è´­ä¹°åŸºé‡‘ã€è‚¡ç¥¨å’Œå€ºåˆ¸ï¼Œæˆ–è€…è¿›è¡Œæ··åˆæŠ•èµ„ã€‚è®¾è®¡ä¸€ä¸ªè®¡ç®—å™¨æ¥è®¡ç®—ä½ æŠ•èµ„å’Œæ”¶ç›Šã€‚

å®šä¹‰ä¸€ä¸ªç±»ç”¨æ¥ä¿å­˜æœ¬é‡‘å’ŒæŠ•èµ„å¹´é™

```python
class Investment:
    def __init__(self, principal, years):
        self.principal = principal
        self.years = years

    def show_info(self):
        print(f'æœ¬é‡‘ï¼š{self.principal}å…ƒï¼Œå¹´é™ï¼š{self.years}')

inv = Investment(10000, 3)
inv.show_info()
```

## ç»§æ‰¿

æŠ•èµ„æ–¹å¼ï¼šå®šæœŸå­˜æ¬¾ã€åŸºé‡‘ã€è‚¡ç¥¨å’Œå€ºåˆ¸éƒ½æ˜¯åœ¨æœ¬é‡‘åŸºç¡€ä¸Šè®¡ç®—åˆ©æ¯ã€‚æˆ‘ä»¬å¯ä»¥åˆ†åˆ«åˆ›å»ºç±»ï¼Œæ¥è®¡ç®—æ”¶ç›Šï¼Œå¯ä»¥æ‹“å±•`Investment`åªæ·»åŠ è®¡ç®—æ”¶ç›Šçš„åŠŸèƒ½ã€‚

### ç»§æ‰¿çš„æ¦‚å¿µ

ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªåŸºæœ¬ç‰¹æ€§ï¼Œå®ƒå…è®¸ä¸€ä¸ªç±»ï¼ˆå­ç±»ï¼‰åŸºäºå¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»ï¼‰æ¥æ„å»ºï¼Œä»è€Œè·å¾—çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶å¯ä»¥æ·»åŠ æ–°çš„åŠŸèƒ½æˆ–ä¿®æ”¹ç°æœ‰åŠŸèƒ½ã€‚çˆ¶ç±»ä¹Ÿè¢«ç§°ä¸ºåŸºç±»æˆ–è¶…ç±»ã€‚

å®šä¹‰ä¸€ä¸ªå®šæœŸå­˜æ¬¾ç±»ç»§æ‰¿`Investment`ï¼Œç”¨äºè®¡ç®—å®šæœŸå­˜æ¬¾çš„æ”¶ç›Šã€‚

```python
class FixedDeposit(Investment):
    def __init__(self, principal, years):
        super().__init__(principal, years)
```

ç±»çš„ç»§æ‰¿å…³ç³»å›¾å¦‚ä¸‹ï¼š

```mermaid
classDiagram
    Investment <|-- FixedDeposit
```

å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå®šä¹‰å­ç±»çš„å®ä¾‹ï¼Œå¯ä»¥è°ƒç”¨çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚

```python
fixed = FixedDeposit(10000, 3)
fixed.show_info()
```

`super()`æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œé€šè¿‡å®ƒå¯ä»¥åœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚é€šè¿‡è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå®Œæˆäº†å±æ€§çš„ç»§æ‰¿ã€‚

```python
class FixedDeposit(Investment):
    def __init__(self, principal, years):
        pass

fixed = FixedDeposit(10000, 3)
print(f'fixed.principal = {fixed.principal}')
```

* ä¸Šé¢ä»£ç ä¼šæŠ¥é”™ï¼Œ`principal`å±æ€§æ²¡æœ‰ç»§æ‰¿ã€‚

`__mro__`æ˜¯Pythonä¸­ç±»çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºæŸ¥çœ‹ç±»çš„ç»§æ‰¿é¡ºåºã€‚

```python
print(FixedDeposit.__mro__)
```

ä¸Šé¢çš„ç»§æ‰¿é¡ºåºå¦‚ä¸‹

```shell
(<class '__main__.FixedDeposit'>, <class '__main__.Investment'>, <class 'object'>)
```

å…¶ä¸­`object`ç±»æ˜¯Pythonè¯­è¨€ä¸­çš„é»˜è®¤ç»§æ‰¿ç±»ï¼Œæˆä¸ºé¡¶çº§ç±»ã€‚

> [!warning]
>
> Pythonä¸­ç»§æ‰¿çš„å±‚æ¬¡å¯ä»¥æ— é™å»¶å±•ï¼Œä½†æ˜¯å¸¸ç”¨çš„æ¶æ„è®¾è®¡é€šå¸¸å»ºè®®ç±»çš„ç»§æ‰¿å±‚æ¬¡ä¸è¦è¶…è¿‡3-4å±‚ï¼ˆä¸åŒ…æ‹¬objectç±»ï¼‰ã€‚

ä¸Šé¢`Investment`çš„å®šä¹‰ç­‰ä»·äºä¸‹é¢çš„å†™æ³•

```python
class Investment(object):
    def __init__(self, principal, years):
        self.principal = principal
        self.years = years

    def show_info(self):
        print(f'æœ¬é‡‘ï¼š{self.principal}å…ƒï¼Œå¹´é™ï¼š{self.years}')
```

* ä¸Šé¢çš„ç±»ç§°ä¸ºæ–°å¼ç±»ï¼Œæ²¡æœ‰`object`ç§°ä¸ºç»å…¸ç±»ã€‚
* Ptyhon2ä¸­æœ‰ç»å…¸ç±»å’Œæ–°å¼ç±»çš„åŒºåˆ«ï¼ŒPtyhon3ä¸­è¿™ç§å·®å¼‚å·²å–æ¶ˆã€‚

### å­ç±»çš„å±æ€§å’Œæ–¹æ³•

å½“å­ç±»ç»§æ‰¿çˆ¶ç±»åå¯ä»¥ç»™å­ç±»æ·»åŠ æ–°çš„å±æ€§å’Œæ–¹æ³•ã€‚

```python
class FixedDeposit(Investment):
    def __init__(self, principal, years, rate):
        super().__init__(principal, years)
        self.rate = rate

    def calculate_return(self):
        # å¤åˆ©è®¡ç®—ï¼šæœ¬é‡‘ * (1 + åˆ©ç‡)^å¹´é™
        total = self.principal * (1 + self.rate) ** self.years
        profit = total - self.principal
        return total, profit

fixed = FixedDeposit(10000, 3, 0.05)
total, profit = fixed.calculate_return()
print(f'æ€»é‡‘é¢ï¼š{total:.2f}å…ƒï¼Œåˆ©æ¶¦ï¼š{profit:.2f}å…ƒ')
```

* ç»™å®šæœŸç±»æ·»åŠ åˆ©ç‡å’Œæ”¶ç›Šè®¡ç®—ã€‚

### é‡å†™æ–¹æ³•å’Œå±æ€§

å­ç±»å’Œçˆ¶ç±»å…·æœ‰åŒåå±æ€§å’Œæ–¹æ³•ï¼Œé»˜è®¤ä½¿ç”¨å­ç±»çš„åŒåå±æ€§å’Œæ–¹æ³•ã€‚

```python
class FixedDeposit(Investment):
    def __init__(self, principal, years, rate):
        super().__init__(principal, years)
        self.rate = rate

    def show_info(self):
        print(f'æœ¬é‡‘ï¼š{self.principal}å…ƒï¼Œå¹´é™ï¼š{self.years}ï¼Œåˆ©ç‡ï¼š{self.rate}')
        
fixed = FixedDeposit(10000, 3, 0.05)
fixed.show_info()
```

> [!attention]
>
> é‡å†™çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œå¿…é¡»ä¿è¯æ–¹æ³•åå’Œå‚æ•°ä¸€è‡´ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

```python
class FixedDeposit(Investment):
    def __init__(self, principal, years, rate):
        super().__init__(principal, years)
        self.rate = rate

    def show_info(self, name):
        print(f'{name}-æœ¬é‡‘ï¼š{self.principal}å…ƒï¼Œå¹´é™ï¼š{self.years}ï¼Œåˆ©ç‡ï¼š{self.rate}')

fixed = FixedDeposit(10000, 3, 0.05)
fixed.show_info()
```

### å¤šä¸ªå­ç±»

å¯ä»¥å®šä¹‰å¤šä¸ªå­ç±»æ¥ç»§æ‰¿ç›¸åŒçš„çˆ¶ç±»ï¼Œè¿™é‡Œå®šä¹‰ä¸€ä¸ªåŸºé‡‘ç±»ï¼Œç”¨äºåŸºé‡‘çš„æŠ•èµ„è®¡ç®—ã€‚

```python
class Fund(Investment):
    def __init__(self, principal, years, management_fee, expected_return):
        super().__init__(principal, years)
        self.management_fee = management_fee   
        self.expected_return = expected_return 
    
    def calculate_return(self):
        net_return = self.expected_return - self.management_fee
        total = self.principal * (1 + net_return) ** self.years
        profit = total - self.principal
        return total, profit
    
    def show_info(self):
        print(f'æœ¬é‡‘ï¼š{self.principal}å…ƒï¼Œå¹´é™ï¼š{self.years}ï¼Œç®¡ç†è´¹ç‡ï¼š{self.management_fee*100:.2f}%ï¼Œé¢„æœŸæ”¶ç›Šï¼š{self.expected_return*100:.2f}%')
        
fund = Fund(10000, 3, 0.005, 0.08)
fund.show_info()
total, profit = fund.calculate_return()
print(f'æ€»é‡‘é¢ï¼š{total:.2f}å…ƒï¼Œåˆ©æ¶¦ï¼š{profit:.2f}å…ƒ')
```

### å¤šç»§æ‰¿

> [!note]
>
> æ€è€ƒè¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œæ¯ä¸ªæœˆç”¨æˆ·éƒ½å¯ä»¥æ”¶åˆ°æ‰‹æœºçš„è¯è´¹é€šçŸ¥ï¼Œè¿™äº›é€šçŸ¥å¯ä»¥é€šè¿‡æ‰‹æœºé€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é‚®ä»¶å‘é€ã€‚è®¾è®¡å·¥å…·ç±»ç”Ÿæˆå‘é€ä¿¡æ¯ã€‚

å®šä¹‰ä¸€ä¸ªé€šçŸ¥ç±»ï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯å¹¶ç”Ÿæˆæ¶ˆæ¯ã€‚

```python
class Notification:
    def __init__(self, user, account_balance, monthly_bill):
        self.user = user
        self.account_balance = account_balance
        self.monthly_bill = monthly_bill

    def calculate_new_balance(self):
        return self.account_balance - self.monthly_bill

    def get_note(self):
        new_balance = self.calculate_new_balance()
        if new_balance < 0:
            return f'äº²çˆ±çš„ç”¨æˆ·{self.user}ï¼Œæˆªæ­¢ä¸Šæœˆåº•ï¼Œæ‚¨å·²æ¬ è´¹ï¼š{new_balance:.2f}å…ƒï¼Œè¯·åŠæ—¶å……å€¼ã€‚'
        else:
            return f'äº²çˆ±çš„ç”¨æˆ·{self.user}ï¼Œæˆªæ­¢ä¸Šæœˆåº•ï¼Œæ‚¨çš„è´¦æˆ·ä½™é¢ä¸ºï¼š{self.calculate_new_balance():.2f}å…ƒã€‚'

note = Notification('å¼ ä¸‰', 100, 84)
print(note.get_note()) 
note = Notification('æå››', 100, 128)
print(note.get_note())
```

å®šä¹‰ä¸¤ä¸ªç±»ç”¨äºåˆ†åˆ«ç»™æ‰‹æœºå’Œé‚®ç®±å‘é€é€šçŸ¥ä¿¡æ¯ã€‚

```python
class EmailNotification(Notification):
    def __init__(self, user, account_balance, monthly_bill, email):
        super().__init__(user, account_balance, monthly_bill)
        self.email = email

    def send(self):
        print(f'è°ƒç”¨ã€é‚®ç®±ã€‘apiæ¥å£å‘{self.email}å‘é€ ğŸ“§')
        print('-'*50)
        msg = f'ç”¨æˆ·ï¼Œæ‚¨å¥½ï¼š\n'
        msg += self.get_note()
        msg += f'\n\n'
        msg += ' ' * 36
        msg += 'ã€ä¸­å›½è”é€šã€‘'
        print(msg)

class SmsNotification(Notification):
    def __init__(self, user, account_balance, monthly_bill, phone):
        super().__init__(user, account_balance, monthly_bill)
        self.phone = phone

    def send(self):
        print(f'è°ƒç”¨ã€çŸ­ä¿¡ã€‘apiæ¥å£å‘{self.phone}å‘é€çŸ­ä¿¡ ğŸ“±')
        print('-'*50)
        msg = f'ã€ä¸­å›½è”é€šã€‘'
        msg += self.get_note()
        print(msg)

print('=' * 50)
email = EmailNotification('å¼ ä¸‰', 100, 84, 'zhangsan@example.com')
email.send()
print('=' * 50)
sms = SmsNotification('å¼ ä¸‰', 100, 84, '13800001234')
sms.send()
print('=' * 50)
```

å¦‚æœå¸Œæœ›åŒæ—¶å‘é€é‚®ä»¶å’ŒçŸ­ä¿¡å¯ä»¥å®šä¹‰`MultiChannelNotifier`åŒæ—¶å‘é€é‚®ä»¶å’ŒçŸ­ä¿¡

```python
class MultiChannelNotifier(EmailNotification, SmsNotification):
    def __init__(self, user, account_balance, monthly_bill, email, phone):
        Notification.__init__(self, user, account_balance, monthly_bill)
        self.email = email
        self.phone = phone

    def send(self):
        print('=' * 50)
        EmailNotification.send(self)
        print('=' * 50)
        SmsNotification.send(self)
        print('=' * 50)

d = MultiChannelNotifier('å¼ ä¸‰', 100, 84, 'zhangsan@example.com', '13800001234')
d.send()
```

* ä¸Šè¿°ç±»åˆå§‹åŒ–æ—¶ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨`super`ï¼Œå› ä¸ºä¸¤ä¸ªçˆ¶ç±»çš„å‚æ•°ä¸ä¸€è‡´ã€‚
* ä½¿ç”¨`Notification`åˆå§‹åŒ–å…±åŒå‚æ•°ï¼Œç„¶åå†åˆ†åˆ«å¯¹ä¸ªåˆ«å‚æ•°åˆå§‹åŒ–ã€‚
* é‡å†™`send`æ—¶éœ€è¦åˆ†åˆ«è°ƒç”¨`EmailNotification`å’Œ`SmsNotification`çš„ç‹¬ç«‹æ–¹æ³•ã€‚

ä¸Šè¿°ç±»çš„å…³ç³»å›¾ã€‚

```mermaid
classDiagram
    Notification <|-- EmailNotification
    Notification <|-- SmsNotification
    EmailNotification <|-- MultiChannelNotifier
    SmsNotification <|-- MultiChannelNotifier
```

åœ¨å¤šç»§æ‰¿ä¸­ä¼šè°ƒç”¨`super().__init__()`å‡½æ•°ä¼šæŒ‰ç…§ç»§æ‰¿é“¾ä»åå‘å‰çš„é¡ºç€æ‰§è¡Œï¼Œåæ‰§è¡Œçš„åˆå§‹åŒ–å€¼ä¼šè¦†ç›–ä¹‹å‰çš„å€¼ã€‚

```python
class Notification:
    def __init__(self):
        self.name = 'Notification'
        print('Notification __init__')
        
class EmailNotification(Notification):
    def __init__(self):
        super().__init__()
        self.name = 'EmailNotification'
        print('EmailNotification __init__')
        
class SmsNotification(Notification):
    def __init__(self):
        super().__init__()
        self.name = 'SmsNotification'
        print('SmsNotification __init__')
        
class MultiChannelNotifier(EmailNotification, SmsNotification):
    def __init__(self):
        super().__init__()
        self.name = 'MultiChannelNotifier'
        print('MultiChannelNotifier __init__')
        
note = MultiChannelNotifier()
print(MultiChannelNotifier.__mro__)
print(note.name)
```

> [!warning]
>
> å°½ç®¡ Python æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œä½†åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨å¤šé‡ç»§æ‰¿è¦è°¨æ…ã€‚

### ç§æœ‰çš„ç»§æ‰¿

ç§æœ‰æ–¹æ³•å’Œå‡½æ•°æ— æ³•è¢«ç»§æ‰¿

```python
class Investment:
    def __init__(self, principal, years):
        self.__principal = principal
        self.__years = years

    def __show_info(self):
        print(f'æœ¬é‡‘ï¼š{self.principal}å…ƒï¼Œå¹´é™ï¼š{self.years}')

class FixedDeposit(Investment):
    def __init__(self, principal, years):
        super().__init__(principal, years)

fixed = FixedDeposit(10000, 3)
print(f'æœ¬é‡‘ï¼š{fixed.__principal}å…ƒï¼Œå¹´é™ï¼š{fixed.__years}')

fixed.__show_info()
```

* ç§æœ‰çš„æ–¹æ³•å’Œå±æ€§åªèƒ½åœ¨å†…éƒ¨è°ƒç”¨ï¼Œæ— æ³•åœ¨ç±»çš„å¤–éƒ¨è°ƒç”¨ã€‚
* ç§æœ‰çš„æ–¹æ³•å’Œå±æ€§ï¼Œä¸èƒ½è¢«ç»§æ‰¿ã€‚

> [!warning]
>
> ç±»ä¼¼C++å’ŒJavaè¯­è¨€éƒ½æœ‰ä¿æŠ¤çš„å±æ€§å’Œæ–¹æ³•ï¼ŒPythonè¯­æ³•ä¸­ä¸æ”¯æŒä¿æŠ¤å±æ€§å’Œæ–¹æ³•ã€‚

## å¤šæ€

> [!note]
>
> æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œå¯¹äºé€šçŸ¥åº”ç”¨ï¼Œå¦‚æœå¢åŠ ä¸€ä¸ªå¾®ä¿¡é€šçŸ¥çš„å­ç±»ï¼Œå†å®ç°å¤šæ¸ é“é€šçŸ¥æ˜¯ä¸æ˜¯ï¼Œéœ€è¦ä¿®æ”¹`MultiChannelNotifier`ã€‚å¦‚ä½•åœ¨ä¸ä¿®æ”¹`MultiChannelNotifier`çš„åŒæ—¶å¢åŠ å¾®ä¿¡é€šçŸ¥ã€‚

```python
class WXNotification(Notification):
    def __init__(self, user, account_balance, monthly_bill, wxid):
        super().__init__(user, account_balance, monthly_bill)
        self.wxid = wxid

    def send(self):
        print(f'è°ƒç”¨ã€å¾®ä¿¡ã€‘apiæ¥å£å‘{self.wxid}æ¨é€æ¶ˆæ¯ ğŸ“±')
        print('-'*50)
        msg = self.get_note()
        print(msg)


note = WXNotification('å¼ ä¸‰', 100, 84, 'zs-wx')
note.send()
```

åœ¨æ¶ˆæ¯æ¨é€çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼šé‚®ä»¶ã€çŸ­ä¿¡å’Œå¾®ä¿¡æ¨é€éƒ½æœ‰`send`æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£æ¥æ¨é€æ¶ˆæ¯ã€‚å¯¹äºè¿™ç§å…±æœ‰çš„è¡Œä¸ºï¼Œå¯ä»¥åœ¨åŸºç±»é‡Œå®šä¹‰æ¥å£å‡½æ•°ã€‚





å¤šæ€æ˜¯ä¸€ç§ä½¿ç”¨å¯¹è±¡çš„æ–¹å¼ï¼Œå­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œè°ƒç”¨ä¸åŒå­ç±»å¯¹è±¡çš„ç›¸åŒçˆ¶ç±»æ–¹æ³•ï¼Œå¯ä»¥äº§ç”Ÿä¸åŒçš„æ‰§è¡Œç»“æœ

å®ç°æ­¥éª¤ï¼š

1. å®šä¹‰çˆ¶ç±»ï¼Œå¹¶æä¾›å…¬å…±æ–¹æ³•ã€‚
2. å®šä¹‰å­ç±»ï¼Œå¹¶é‡å†™çˆ¶ç±»æ–¹æ³•ã€‚
3. ä¼ é€’å­ç±»å¯¹è±¡ç»™è°ƒç”¨è€…ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒå­ç±»ï¼Œæ‰§è¡Œæ•ˆæœä¸åŒã€‚

```python
class Car:
    def run(self):
        pass
    
class ElectricCar(Car):
    def run(self):
        print('Electric car is running silently.')
        
class GasCar(Car):
    def run(self):
        print('Gas car is running fast.')
        
class Driver:
    def __init__(self, car):
        self.car = car

    def drive(self):
        self.car.run()
        
tesla = ElectricCar()
audi = GasCar()
driver = Driver(tesla)
driver.drive()
driver = Driver(audi)
driver.drive()
```

ä¸Šè¿°å¤šæ€çš„å…³ç³»å›¾å¦‚ä¸‹ï¼š

```mermaid
classDiagram
		Car <|-- ElectricCar
		Car <|-- GasCar
		Driver --> Car
    class Car {
    	+run()
    }
    class ElectricCar {
    	+run()
    }
    class GasCar {
    	+run()
    }
    
    class Driver {
    	+drive()
    }
```

> [!warning]
>
> ç”±äºPythonè¯­è¨€æ˜¯åŠ¨æ€è¯­è¨€ï¼Œå®šä¹‰å˜é‡æ—¶ä¸éœ€è¦æŒ‡å®šç±»å‹ï¼Œæ‰€ä»¥Pythonçš„å¤šæ€ç‰¹æ€§ä¸æ˜æ˜¾ã€‚

`isinstance`å‡½æ•°ç”¨äºåˆ¤æ–­æŸä¸ªå®ä¾‹æ˜¯å¦å±äºæŸä¸ªç±»ï¼Œå­ç±»çš„å®ä¾‹ä¹Ÿå±äºçˆ¶ç±»ã€‚

```python
print(isinstance(tesla, ElectricCar))
print(isinstance(tesla, Car))
print(isinstance(tesla, GasCar))
print(isinstance(tesla, object))
```

## é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§

<img src="https://raw.githubusercontent.com/hughxusu/lesson-py/develop/images/base/threeattr.png" style="zoom: 30%;" />

### `__new__`

`__new__` æ˜¯ä¸€ç§è´Ÿè´£åˆ›å»ºç±»å®ä¾‹çš„æ–¹æ³•ï¼Œæ–¹æ³•é»˜è®¤è¿”å›å®ä¾‹å¯¹è±¡ï¼Œè¯¥æ–¹æ³•æ˜¯ç±»æ–¹æ³•ã€‚

```python
class TodoList:
    def __new__(cls, *args, **kwargs):
        print('1. åˆ›å»ºå®ä¾‹__new__')
        return super().__new__(cls)

    def __init__(self):
        print('2. åˆå§‹åŒ–å®ä¾‹__init__')
        self.items = []

todo_list = TodoList()
```

åˆ›å»ºå®ä¾‹çš„å®Œæ•´è¿‡ç¨‹ï¼š

1. è°ƒç”¨`__new__`åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶è¿”å›è¯¥å®ä¾‹ã€‚
2. `super().__new__(cls)`è¡¨ç¤ºè°ƒç”¨
3. è°ƒç”¨`__init__`åˆå§‹åŒ–å®ä¾‹ä¸­çš„å±æ€§ã€‚

> [!warning]

### å•ä¾‹æ¨¡å¼

ç±»å±æ€§çš„åº”ç”¨ï¼Œå…¨å±€è®¾è®¡ä¸€ä¸ªAppé…ç½®å·¥å…·ã€‚

```python
class AppConfig:
    _instance = None

    def __new__(cls):
        if cls._instance is None:
            inst = super().__new__(cls)
            cls._instance = inst
        return cls._instance

c1 = AppConfig()
c2 = AppConfig()
print(c1 is c2)
```

> [!warning]
>
> pythoné€šå¸¸ä½¿ç”¨`_xxx`æ¥è¡¨ç¤ºåªåœ¨ç±»å†…ä½¿ç”¨ï¼Œä¸å†ç±»å¤–ä½¿ç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ç§çº¦å®šä¿—æˆå†™æ³•ï¼Œä¸å—è¯­æ³•æ”¯æŒã€‚
